<div>
    <div class="x_panel">
        <div class="x_title">
            <h2>
                Новая заявка
                <span v-if="category && category.id"> в очередь {{category.name}}</span>
                <router-link :to="categoryRoute">
                    <small>Обратно в список заявок</small>
                </router-link>
            </h2>
            <div class="clearfix"></div>
        </div>
        <div class="row">
            <form @submit.prevent="submit" @input="errorMessage = ''">
                <div v-if="errorMessage" class="alert alert-danger">{{errorMessage}}</div>
                <div class="col-sm-12">
                    <div v-if="!service" class="form-group" :class="{'has-error': errors.has('category')}">
                        <div class="btn-group" data-toggle="buttons">
                            <label
                                v-for="item in categories"
                                class="btn" :class="{'btn-default': !category || item.id != category.id, 'btn-primary': category && category.id == item.id}"
                                data-toggle-class="btn-primary"
                                data-toggle-passive-class="btn-default"
                                @click="setCategory(item); ticket.category = item.id"
                            >
                                <input
                                    type="radio"
                                    name="category"
                                    v-validate="'required'"
                                    :value="item.id"
                                    v-model="ticket.category" />{{item.name}}
                            </label>
                        </div>
                        <p class="help-block" v-if="errors.has('category')">
                            {{errors.first('category')}}
                        </p>
                    </div>
                    <div class="form-group" :class="{'has-error': errors.has('title')}">
                        <label class="control-label">Заголовок</label>
                        <input type="text" v-model="ticket.title" v-validate="'required|max:200'" name="title" class="form-control" />
                        <p class="help-block" v-if="errors.has('title')">
                            {{errors.first('title')}}
                        </p>
                    </div>
                    <div class="form-group" :class="{'has-error': errors.has('text')}">
                        <label class="control-label">Содержание</label>
                        <textarea rows="10" v-model="ticket.text" class="form-control" v-validate="'required|max:1000'" name="text"></textarea>
                        <p class="help-block" v-if="errors.has('text')">
                            {{errors.first('text')}}
                        </p>
                    </div>
                    <div class="form-group">
                        <button type="submit" :disabled="awaitOfSubmit" class="btn btn-success">Отправить заявку</button>
                        <router-link
                                :to="categoryRoute"
                                :class="{'btn btn-default': true}">Отмена</router-link>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
